<taconite>
{% set dialog_id = 'ie_' ~ content.handler | replace({'-': '_'}) ~ '_dialog' %}

{% set form_id = dialog_id ~ '_form' %}

{% include bundle_name ~ ':' ~ controller_name ~ ':Includes/reload_container.html.twig' %}

{% if action_if_success == 'close' %}

                    <eval><![CDATA[
                ${{ dialog_id }}.dialog('close');
                    ]]>
                    </eval>

{% elseif action_if_success == 'list' %}

                    <eval><![CDATA[
                mmf_ie_ajax('{{ path( 'mmf_ie_content_collection', { 'url_safe_encoded_params' : url_safe_encoded_params }) }}', undefined, '#{{ dialog_id }}');
                    ]]>
                    </eval>

{% else %}

                {% include bundle_name ~ ':' ~ controller_name ~ ':Includes/open_ui_dialog.html.twig' %}


                {% include 'MuchoMasFacilInPageEditBundle:ContentAdmin:Includes/form_template.html.twig' %}

                    <eval><![CDATA[
    $( "#{{ dialog_id }}" ).dialog('option',
    {
        buttons: {
{% if content.isCollection  %}
            '{{ 'List' | trans({}, (bundle_name | lower)) }}': function () {
              mmf_ie_ajax('{{ path( 'mmf_ie_content_collection', { 'url_safe_encoded_params' : url_safe_encoded_params }) }}', undefined, '#{{ dialog_id }}');
            },
{% endif %}
            '{{ 'Save' | trans({}, (bundle_name | lower)) }}': function () {
                $("#{{ form_id }}").ajaxForm({
                  dataType: "xml"
                  , url: "{{ path('mmf_ie_content_item_edit', {'url_safe_encoded_params': url_safe_encoded_params, 'content_order': content_order  }) }}"
                  //,success: $.taconite
                });
                mmf_ie_submit("#{{ form_id }}", "#{{ dialog_id }}" );
            },
{% if content.isCollection %}
          '{{ 'Save and list' | trans({}, (bundle_name | lower)) }}': function () {
                $("#{{ form_id }}").ajaxForm({
                  dataType: "xml"
                  , url: "{{ path('mmf_ie_content_item_edit', {'url_safe_encoded_params': url_safe_encoded_params, 'content_order': content_order, 'action_if_success': 'list'  }) }}"
                  //,success: $.taconite
                });
                mmf_ie_submit("#{{ form_id }}", "#{{ dialog_id }}" );
          },
{% endif %}
          '{{ 'Save and close' | trans({}, (bundle_name | lower)) }}': function () {
                $("#{{ form_id }}").ajaxForm({
                  dataType: "xml"
                  , url: "{{ path('mmf_ie_content_item_edit', {'url_safe_encoded_params': url_safe_encoded_params, 'content_order': content_order, 'action_if_success': 'close'  }) }}"
                  //,success: $.taconite
                });
                mmf_ie_submit("#{{ form_id }}", "#{{ dialog_id }}" );
          }
        }//buttons
    }).dialog('open');
                ]]>
                </eval>

{% endif %}
</taconite>
